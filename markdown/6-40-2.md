<!--navi start1-->
[前へ](6-40-1.md)/[目次](https://opensourcecobol.github.io/markdown/TOC.html)/[次へ](6-41.md)
<!--navi end1-->
### 6.40.2. SORT文の書き方2 ― テーブルソート

|図6-95-SORT構文(テーブルソート)|
|:--|
|![alt text](Image/6-95.png)|

一つ以上のキー項目に従って、比較的少量のデータ、つまり、データ部のテーブルに含まれるデータを整列する。

1. テーブル名データ項目には、OCCURS句が必要である。

2. 一意名-1 ･･･項目が存在する場合は、テーブル名に従属するデータ項目として定義する必要がある。

3. WITH DUPLICATES IN ORDER句は互換性の目的でサポートされているが、機能はしない。

4. テーブル名内のデータは、SORT文で作成されたキー指定に従って所定の位置で整列される(つまり、整列ファイルは必要ない)。

5. 現在、SORT文でキー指定が行われていないテーブルソートはサポートされておらず、コンパイラによって拒否される。

6. 整列は、(存在する場合は)SORT文で指定されたCOLLATING SEQUENCEに従って、SORT文内のASCENDING KEYまたはDESCENDING KEYによって定義した順序でデータレコードを配置することで処理が行われる。何も定義されていない場合は、実行用計算機段落によって、PROGRAM COLLATING SEQUENCEが指定、または暗示される。キーは、レベル78またはレベル88のデータ項目を除いて、サポートされているものであれば、任意のデータ型とUSAGEを設定することができる。

7. SORT文はテーブル名内の所定の位置で実行されるため、整列ファイルは必要ない。

<!--navi start2-->

[ページトップへ](6-40-2.md)
<!--navi end2-->
